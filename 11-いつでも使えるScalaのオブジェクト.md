# いつでも使えるScalaのオブジェクト

## Scalaのオブジェクト

- Scalaにおける「オブジェクト」
  - クラスのインスタンスなどを含めた「オブジェクト全般」を表すとき
  - objectキーワードを使って作られた「オブジェクト」を指すとき

objectキーワードでオブジェクトを作成する

```scala
object オブジェクト名 extends クラス名(トレイト名) with トレイト名1 with トレイト名2 ... {
  本体
}
```

```scala
// Appというアプリケーションの振る舞いをもつトレイトをミックス院したオブジェクトMyApplication
object MyApplication extends App {
  println("Hello!")
}
```

シングルトンオブジェクト：たったひとつのインスタンスしか存在しないオブジェクトのこと

- Scalaのオブジェクトの利用方法
  - グローバルな状態やユーティリティメソッドの実現
  - オブジェクトを作り出すためのメソッドの提供
  - アプリケーションなどのシングルトンオブジェクトの作成


- グローバル変数：いつでもどこでも値を書き替えれられ、値を呼び出せる変数のこと
  - 小さなプログラムであれば非常に便利だが、大きくなると弊害が強くなる
  - グローバル変数の処理はメモリ常に残り続ける

したがって、オブジェクトは、グローバルである必要性のある定数やメソッドに用いるのが適切である、と言える。

ガベージコレクション：不要になったオブジェクトや値をメモリ上から自動的に消してくれる機能のこと。JVMの機能。

## クラスを継承したオブジェクト

クラスのインスタンス化の代わりとして、オブジェクトを使うこともできる。(オブジェクトは型としての性質も持っている)

```scala
class Dog(name: String) {
  def greet(): Unit = println(s"${name}だワン")
}

// Dogクラスを継承したTaroオブジェクト。Dog型のオブジェクトを作成することができる。
object Taro extends Dog("タロウ")

// Taro
// Taro.greet
  // Taro.type = Taro$@53f3bdbd
  // タロウだワン
```

## オブジェクトで作るファクトリメソッド

ファクトリメソッド：クラスのインスタンスを作成するメソッドのこと

apply：：applyメソッドを定義すると特別扱いされる。``オブジェクト名(applyメソッドの引数)``で呼び出すことができる。

(普通は``オブジェクト名.メソッド名``で呼び出す)

オブジェクトは、ファクトリメソッドをつくるためにも用いられる。

```scala
// クラスと同名のオブジェクトをつくる
// applyメソッドを用意する。すると、オブジェクト名(applyメソッドの引数) でこのメソッドが呼び出すことができる。
// applyメソッドに、new Dog(name)としてコンストラクタの機能を与えてやることで、ファクトリメソッドにできる。
object Dog {
  // nameを受け取るファクトリメソッド
  def apply(name: String) = new Dog(name)

  // Int型の数値を受け取るファクトリメソッド
  def apply(id: Int) = new Dog(id)
}
```

Scalaのクラスは、プライマリーコンストラクタというコンストラクタを一つしか持つことができない。よって、引数を変えたいときなどは、ファクトリメソッドを作る。

本来のコンストラクタでのインスタンスの作り方とは違う引数で、クラスのインスタンスを作りたい場合などに有効ということ。

## コンパニオンオブジェクトについて

コンパニオンオブジェクト：クラスと同名のオブジェクトのこと

コンパニオンオブジェクトは、同名のクラスのプライベートメンバーにもアクセスすることができる。

```scala
// クラスDogのnameフィールドはプライベートであり、外部に公開されていない。他のクラスからは使うことができない。
class Dog(private val name: String) {
   def greet(): Unit = println(s"${name}だワン")
}

// コンパニオンオブジェクト(クラスと同名)を作成し、クラスDogのnameにアクセスして、コンソールに出力する
object Dog {
  def printName(dog: Dog): Unit = println(dog.name)
}

// val saburo = new Dog("サブロー") // クラスDogをインスタンス化する
// Dog.printName(saburo) // コンパニオンオブジェクトDogから、非公開のnameにアクセスする

// saburo: Dog = Dog@7ac296f6
// サブロー
```

このように、コンパニオンオブジェクトは、クラスに密接して処理を記述することができる。